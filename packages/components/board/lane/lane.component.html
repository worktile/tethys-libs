<div class="board-lane-header-container d-flex" *ngIf="hasLane" [class.board-lane-header-expanded]="isExpanded">
  <div class="board-lane-header">
    <thy-icon
      thyIconName="angle-down"
      class="lane-expand-icon mr-2"
      [class.lane-expand-icon-collapsed]="!isExpanded"
      (click)="expand()"
    ></thy-icon>

    @if(laneTemplateRef) {

    <ng-template [ngTemplateOutlet]="laneTemplateRef" [ngTemplateOutletContext]="{ lane: lane(), $implicit: lane() }"></ng-template>
    } @else{
    <div class="d-flex justify-content-between text-secondary flex-grow-1 type-container">
      <span thyFlexibleText [thyTooltipContent]="lane().name">
        <span>{{ lane().name }}</span>
      </span>
      <ng-container *ngIf="isExpanded">
        <span class="text-muted flex-shrink-0"
          ><span class="text-secondary mr-1">{{ lane().cards?.length || 0 }}</span
          >个</span
        >
      </ng-container>
    </div>
    }
  </div>
</div>

<div class="board-lane-body" cdkDropListGroup [class.board-no-lane-body]="!hasLane">
  @if(hasLane) { @for (entry of lane().entries; track entry._id) {
  <div
    class="board-lane-body-entry"
    [class.board-lane-body-entry-is-empty]="isExpanded && lane().cards?.length === 0"
    [class.board-lane-body-entry-is-collapsed]="!isExpanded"
  >
    <thy-board-entry
      *ngIf="isExpanded"
      [hasLane]="hasLane"
      [entry]="entry"
      [cardTemplateRef]="cardTemplateRef"
      [lane]="lane()"
    ></thy-board-entry>
    <div class="text-muted mx-5 text-truncate" *ngIf="!isExpanded && entry.cards!.length > 0">
      <span class="text-secondary mr-1">{{ entry.cards!.length }}</span
      >个{{ entry.name }}
    </div>
  </div>
  } } @else{ @for (entry of entries(); track entry._id) {
  <div class="board-lane-body-entry">
    <thy-board-entry [hasLane]="hasLane" [entry]="entry" [cardTemplateRef]="cardTemplateRef" [lane]="lane()"> </thy-board-entry>
  </div>
  } }
</div>

<ng-template #unGroupHeader>
  <span>{{ lane().name }}</span>
</ng-template>
